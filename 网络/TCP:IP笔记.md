[TOC]

### 1.OSI参考模型

- 7.应用层
- 6.表示层
- 5.会话层
- 4.传输层
- 3.网络层
- 2.数据链路层
- 1.物理层


##### 7.应用层

针对特定应用的协议

- TELNET （使用TCP）常用语用于远程登录
- FTP 相邻两台计算机进行文件传输 TCP **21号端口**
- SMTP 电子邮件 TCP **25号端口**

 - IMAP 接收电子邮件的协议
 - POP

- HTTP
- DNS 实现网络设备名字到IP地址映射的网络服务
- SNMP 用于管理与监视网络设备

##### 6.表示层

设备固有数据格式和网络标准数据格式的转换，可以定义数据格式及进行加密

##### 5.会话层

通信管理，负责建立和断开通信连接（数据流动的逻辑通路）

##### 4.传输层

管理两个节点之间的数据传输。

- TCP
- UDP


##### 3.网络层

地址管理和路由选择

- ARP

	解决地址问题的协议，通过目标IP地址，确定下一个应该接收数据包的网络设备的MAC地址，适用于IPv4不适用于IPv6
- IPv4、IPv6
- ICMP

	确认IP包是否成功送达目标地址，通知在发送过程当中IP包被废弃的具体原因，改善网络设置等。

- DHCP

	如果逐一为每一台主机设置IP地址会非常繁琐，为了实现自动设置IP地址、统一管理IP地址分配，就产生了DHCP（Dynamic Host Configuration Protocol）协议。有了DHCP，计算机只要连接到网络就可以进行TCP/IP通信，实现了即插即用。
	
- IPSec
- IGP（内部网关协议）、RIP（路由信息协议）、EGP  

相关技术

- NAT
 
 用于在本地网络中使用私有地址，在连接互联网时转换使用全局IP地址的技术

##### 2.数据链路层

互联设备之间传送和识别数据帧

##### 1.物理层

以“0”、“1”代表电压的高低，界定连接器和网线的规格。

### 2.TCP/IP分层模式

- 应用层
- 传输层
- 网络层
- 数据链路层
- 物理层


>半双工：只发送或只接受的通信方式
>
>全双工：允许在同一时间既可以发送数据也可以接收数据。


### 3.TCP与UDP

##### TCP特点

**1.通过序列号与确认应答提高可靠性**

![TCP三次握手与四次挥手](https://github.com/sparkfengbo/AndroidNotes/blob/master/PictureRes/NET/http%E6%8C%81%E4%B9%85%E8%BF%9E%E6%8E%A51.png?raw=true)

**2.超时重发**

**3.利用窗口控制提高速度**

**4.拥塞控制**

--


- [关于TCP/IP，必知必会的十个问题](https://mp.weixin.qq.com/s/qn5fw8yHvjBou6Ps2Xo9Lw)


### 4.TCP SYN攻击

- [TCP三次握手与DDOS攻击原理](https://www.cnblogs.com/howhy/p/6382432.html)

>在TCP/IP协议中，TCP协议提供可靠的连接服务，采用三次握手建立一个连接。 

>- 第一次握手：建立连接时，客户端发送syn包(syn=j)到服务器，并进入SYN_SEND状态，等待服务器确认； 

>- 第二次握手：服务器收到syn包，必须确认客户的SYN（ack=j+1），同时自己也发送一个SYN包（syn=k），即SYN+ACK包，此时服务器进入SYN_RECV状态； 

>- 第三次握手：客户端收到服务器的SYN＋ACK包，向服务器发送确认包ACK(ack=k+1)，此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。 

**重要概念**

>- 未连接队列：在三次握手协议中，服务器维护一个未连接队列，该队列为每个客户端的SYN包（syn=j）开设一个条目，该条目表明服务器已收到SYN包，并向客户发出确认，正在等待客户的确认包。这些条目所标识的连接在服务器处于Syn_RECV状态，当服务器收到客户的确认包时，删除该条目，服务器进入ESTABLISHED状态。 
>- Backlog参数：表示未连接队列的最大容纳数目。 
>- SYN-ACK 重传次数：服务器发送完SYN－ACK包，如果未收到客户确认包，服务器进行首次重传，等待一段时间仍未收到客户确认包，进行第二次重传，如果重传次数超过系统规定的最大重传次数，系统将该连接信息从半连接队列中删除。注意，每次重传等待的时间不一定相同。 
>- 半连接存活时间：是指半连接队列的条目存活的最长时间，也即服务从收到SYN包到确认这个报文无效的最长时间，该时间值是所有重传请求包的最长等待时间总和。有时我们也称半连接存活时间为Timeout时间、SYN_RECV存活时间。
>
>假设一个用户向服务器发送了SYN报文后突然死机或掉线，那么服务器在发出SYN+ACK应答报文后是无法收到客户端的ACK报文的（第三次握手无法完成），这种情况下服务器端一般会重试（再次发送SYN+ACK给客户端）并等待一段时间后丢弃这个未完成的连接，这段时间的长度我们称为SYN Timeout，一般来说这个时间是分钟的数量级（大约为30秒-2分钟）；一个用户出现异常导致服务器的一个线程等待1分钟并不是什么很大的问题，但如果有一个恶意的攻击者大量模拟这种情况，服务器端将为了维护一个非常大的半连接列表而消耗非常多的资源----数以万计
的半连接，即使是简单的保存并遍历也会消耗非常多的CPU时间和内存，何况还要不断对这个列表中的IP进行SYN+ACK的重试。实际上如果服务器的TCP/IP栈不够强大，最后的结果往往是堆栈溢出崩溃---即使服务器端的系统足够强大，服务器端也将忙于处理攻击者伪造的TCP连接请求而无暇理睬客户的正常请求（毕竟客户端的正常请求比率非常之小），此时从正常客户的角度看来，服务器失去响应，这种情况我们称做：服务器端受到了SYN Flood攻击（SYN洪水攻击）
